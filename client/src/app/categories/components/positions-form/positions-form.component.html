<ng-container>
    <div class="center-align mb1 mt0 blue-text">
        <span class="category">{{categoryName}}</span>
    </div>

    <div class="card-width row" *ngIf="!loading; else loader">
        <div class="col s12 " *ngIf="sortingSelected === ''">
            <div *ngIf="positions$ | async as positions">
                <div *ngFor="let position of positions | paginate: {itemsPerPage: paginationStep,currentPage: p};" class="card col s12 m6 l4">
                    <div class="card-image waves-effect waves-block waves-light mb0">
                        <img class="img activator center-block" src={{position.imageSrc}}>
                    </div>
                    <div class="card-content">
                        <hr class="hr1">
                        <div class="card-title activator grey-text text-darken-4">
                            <p class="name" [title]="position.name">{{position.name}}</p>
                            <p></p>
                        </div>
                        <hr class="hr1">
                        <div class="cost center mb4">{{position.cost}} грн</div>
                        <div *ngIf="position.quantity" class="availability green-text center mt4">в наявності</div>
                        <div *ngIf="!position.quantity" class="availability blue-text center mt4">очікується</div>
                    </div>
                    <div class="card-action mt0 center-align" (click)="onSelectPosition(position)">
                        <button class="add waves-effect waves-light btn " (click)="open()" [disabled]="!position.quantity"><i
                                class="addIcon material-icons ">shopping_cart</i></button>
                    </div>
                    <div class="card-reveal">
                        <span class="card-title text-size grey lighten-5">{{position.name}}<i
                                class="material-icons right">close</i></span>
                        <span class="description">{{position.description}}</span>
                    </div>
                </div>
            </div>
            <div class="col s12">
                <pagination-controls (pageChange)="p = $event" previousLabel="" nextLabel="">
                </pagination-controls>
            </div>
        </div>
    </div>
    <div class="card-width row" *ngIf="!loading; else loader">
        <div *ngIf="sortingSelected === increase">
            <div *ngIf="positionsByInc$ | async as positions">
                <div *ngFor="let position of positions | paginate: {itemsPerPage: 6,currentPage: p};" class="card col s12 m6 l4">
                    <div class="card-image waves-effect waves-block waves-light mb0">
                        <img class="img activator center-block" src={{position.imageSrc}}>
                    </div>
                    <div class="card-content">
                        <hr class="hr1">
                        <div class="card-title activator grey-text text-darken-4">
                            <p class="name" [title]="position.name">{{position.name}}</p>
                            <p></p>
                        </div>
                        <hr class="hr1">
                        <div class="cost center mb4">{{position.cost}} грн</div>
                        <div *ngIf="position.quantity" class="availability green-text center mt4">в наявності</div>
                        <div *ngIf="!position.quantity" class="availability blue-text center mt4">очікується</div>
                    </div>
                    <div class="card-action mt0 center-align" (click)="onSelectPosition(position)">
                        <button class="add waves-effect waves-light btn " (click)="open()" [disabled]="!position.quantity"><i
                                class="addIcon material-icons ">shopping_cart</i></button>
                    </div>
                    <div class="card-reveal">
                        <span class="card-title text-size grey lighten-5">{{position.name}}<i
                                class="material-icons right">close</i></span>
                        <span class="description">{{position.description}}</span>
                    </div>
                </div>
            </div>
            <div class="col s12">
                <pagination-controls (pageChange)="p = $event" previousLabel="" nextLabel="">
                </pagination-controls>
            </div>
        </div>
    </div>
    <div class="card-width row" *ngIf="!loading; else loader">
        <div *ngIf="sortingSelected === decrease">
            <div *ngIf="positionsByDec$ | async as positions">
                <div *ngFor="let position of positions | paginate: {itemsPerPage: 6,currentPage: p};" class="card col s12 m6 l4">
                    <div class="card-image waves-effect waves-block waves-light mb0">
                        <img class="img activator center-block" src={{position.imageSrc}}>
                    </div>
                    <div class="card-content">
                        <hr class="hr1">
                        <div class="card-title activator grey-text text-darken-4">
                            <p class="name" [title]="position.name">{{position.name}}</p>
                            <p></p>
                        </div>
                        <hr class="hr1">
                        <div class="cost center mb4">{{position.cost}} грн</div>
                        <div *ngIf="position.quantity" class="availability green-text center mt4">в наявності</div>
                        <div *ngIf="!position.quantity" class="availability blue-text center mt4">очікується</div>
                    </div>
                    <div class="card-action mt0 center-align" (click)="onSelectPosition(position)">
                        <button class="add waves-effect waves-light btn " (click)="open()" [disabled]="!position.quantity"><i
                                class="addIcon material-icons ">shopping_cart</i></button>
                    </div>
                    <div class="card-reveal">
                        <span class="card-title text-size grey lighten-5">{{position.name}}<i
                                class="material-icons right">close</i></span>
                        <span class="description">{{position.description}}</span>
                    </div>
                </div>
            </div>
            <div class="col s12">
                <pagination-controls (pageChange)="p = $event" previousLabel="" nextLabel="">
                </pagination-controls>
            </div>
        </div>
    </div>
</ng-container>

<ng-template #loader>
    <app-loader></app-loader>
</ng-template>

<div class="modal" #modal>
    <div *ngIf="positions$ | async as positions">
        <div *ngFor="let position of positions">
            <div *ngIf="position._id == positionId">
                <div class="modal-content">
                    <span>Найменування товару: {{position.name}}</span>
                    <span class="right">Ціна: {{position.cost}} UAH</span>
                    <input #quantityInput id="pos-quantity" type="number" [(ngModel)]="position.orderQuantity">
                    <label for="pos-quantity">Кількість</label>
                </div>
                <div class="modal-footer">
                    <button type="button" (click)="onCancel()" class="modal-action waves-effect waves-black btn-flat">
                        Скасувати
                    </button>
                    <button class="modal-action btn waves-effect btn-small" type="submit" (click)="addToCart(position)" [disabled]="!position.orderQuantity">
                        Додати в кошик
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>